C51 COMPILER V9.56.0.0   STC12C5A60S2_PWM                                                  11/05/2017 17:57:25 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE STC12C5A60S2_PWM
OBJECT MODULE PLACED IN ..\obj\STC12C5A60S2_PWM.obj
COMPILER INVOKED BY: D:\keil5\C51\BIN\C51.EXE ..\src\motor\STC12C5A60S2_PWM.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\src\nrf
                    -24l01;..\src\ADC;..\src\color_sensor;..\src\delay;..\src\DHT11;..\src\FM_ctrl;..\src\Infrared Sensor;..\src\light;..\src
                    -\motor;..\src\uart;..\src\user;..\src\HCSR04) DEBUG OBJECTEXTEND PRINT(..\obj\STC12C5A60S2_PWM.lst) TABS(2) OBJECT(..\ob
                    -j\STC12C5A60S2_PWM.obj)

line level    source

   1          #include "STC12C5A60S2_PWM.h"
   2          #include <STC12C5A60S2.H>
   3          
   4          
   5          void PWM_ini()
   6          {
   7   1        CMOD=0x0C;//ʱ0Ϊʱ룬ѡFOSC/6ΪʱԴ,11.0592MHZʱPWMƵ=11059200/6/256=7.2K
             -hz        
   8   1        CL=0x00;//ɵ16λʱֵ CLֵPCAʱģCLֵڻڣEPCnLCCAP
             -nLʱΪߡ
   9   1        CH=0x00;//CH0Ϊ00  ṹͼCLǰԶ0
  10   1      
  11   1          /***PWM0ؼĴ***/
  12   1        PCA_PWM0=0x00; //EPC0H=0,EPC0L=0 EPC0HCCAP0HϳɲĴEPC0HCCAP0H
  13   1        //                               EPC0LCCAP0LϳɲĴEPC0LCCAP0L
  14   1                //  PCA_PWMn: 7 6 5 4 3 2 1 0
  15   1                //; - - - - - - EPCnH EPCnL
  16   1        CCAPM0=0x42;//ECOM1=1,PWM1=1.
  17   1                    //PCAģ0ĹģʽĴ
  18   1                      //---------------------------------------
  19   1                      //7   6    5     4     3    2    1    0
  20   1                      //- ECM0 CAPP0 CAPN0 MAT0 T0G0 PWM0 ECCF0
  21   1                      //----1----0-----0----0-----0---1-----0---
  22   1                      //ECOM0:ʹܱȽ1ʱʹܱȽ
  23   1                      //CAPP01ʱʹز
  24   1                      //CAPN01ʱʹ½ز
  25   1                      //MAT0:ƥ:1ʱPCAֵģıȽ/Ĵֵƥ佫λCCONĴжϱ־λCCF
             -n
  26   1                      //T0G0:ת1ʱPCAģʽPCAֵģıȽ/Ĵֵƥ佫C
             -EXnŷת
  27   1                      //PWM0:ģʽ1ʱʹCEXnPWM
  28   1                      //EECF0:ʹCCFnжϣʹܼĴCCONеĲ/Ƚϱ־CCFnж
  29   1          /***PWM1ؼĴ***/
  30   1        PCA_PWM1=0x00;//EPC1H=0,EPC1L=0 EPC1HCCAP0HϳɲĴEPC1HCCAP1H
  31   1                //EPC1LCCAP0LϳɲĴEPC1LCCAP1L
  32   1                        //  PCA_PWMn: 7 6 5 4 3 2 1 0
  33   1                //; - - - - - - EPCnH EPCnL 
  34   1        CCAPM1=0x42;//ECOM1=1,PWM1=1.
  35   1                    //PCAģ0ĹģʽĴ
  36   1                      //---------------------------------------
  37   1                      //7   6    5     4     3    2    1    0
  38   1                      //- ECM1 CAPP1 CAPN1 MAT1 T0G1 PWM1 ECCF1
  39   1                      //----1----0-----0----0-----0---1-----0---
  40   1                      //ECOM1:ʹܱȽ1ʱʹܱȽ
  41   1                      //CAPP11ʱʹز
  42   1                      //CAPN11ʱʹ½ز
  43   1                      //MAT1:ƥ:1ʱPCAֵģıȽ/Ĵֵƥ佫λCCONĴжϱ־λCCF
             -n
  44   1                      //T0G1:ת1ʱPCAģʽPCAֵģıȽ/Ĵֵƥ佫C
             -EXnŷת
  45   1                      //PWM1:ģʽ1ʱʹCEXnPWM
  46   1                      //EECF1:ʹCCFnжϣʹܼĴCCONеĲ/Ƚϱ־CCFnж
C51 COMPILER V9.56.0.0   STC12C5A60S2_PWM                                                  11/05/2017 17:57:25 PAGE 2   

  47   1                                                                                                               
  48   1        /***PCAм***/
  49   1        CR=1;//CR=1,PCAм  151ҳкCMODCIDLλйأֺIDLEйأ183ҳ
  50   1          /***PWMP4***/
  51   1          /***40STCƬ***/
  52   1        //AUXR1=0xc0;//PWM0P1.3лP4.2
  53   1                       //PWM1P1.4лP4.3                                                                         
             -                                                                                                                        
             -                        
  54   1      
  55   1      }
  56          
  57          void PWM_Set(unsigned char PWM0_DATA,unsigned char PWM1_DATA)
  58          {
  59   1              CCAP0L=PWM0_DATA;//װȽϳֵ
  60   1              CCAP0H=PWM0_DATA;
  61   1              CCAP1L=PWM1_DATA;//װȽϳֵ
  62   1              CCAP1H=PWM1_DATA;
  63   1      }
  64          
  65          //ѡFOSC/6ΪʱԴ,11.0592MHZʱPWMƵ=11059200/6/256=7.2Khz
  66          //һ=1/7.2K= 0.1388ms
  67          //һڷֳ256=0.1388ms/256=0.0005421875ms
  68          
  69          //ڵCLֵڻڣEPCnLCCAPnLʱΪߡCLΪ0ԣ
  70          //PWM0㷽PWM1Ҳһ
  71          //ߵƽʱڵ͵ƽʱCCAP0L=127;CCAP0H=127;  ߵ͵ƽʱ128*0.0005421875ms=0.0694ms
             -ԼΪ0.0694ms X 2 = 0.1388ms
  72          //ߵƽʱ㣺256-CCAP0LX 0.0005421875ms
  73          //͵ƽʱ㣺CCAP0L X 0.0005421875ms


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     30    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
